{% extends 'base.html.twig' %}

{% block title %}Hello MainController!{% endblock %}

{% block stylesheets %}
<style>
    .feed {
        max-width: 600px;
        margin: 0 auto;
    }

    .post-card {
        background: white;
        border: 1px solid var(--border-color);
        border-radius: 3px;
        margin-bottom: 24px;
    }

    .post-header {
        display: flex;
        align-items: center;
        padding: 14px 16px;
        border-bottom: 1px solid var(--border-color);
    }

    .post-user {
        font-weight: 600;
        text-decoration: none;
        color: var(--text-color);
    }

    .post-image {
        width: 100%;
        max-height: 600px;
        object-fit: cover;
    }

    .post-actions {
        padding: 8px 16px;
        border-top: 1px solid var(--border-color);
    }

    .post-likes {
        margin: 8px 0;
        font-weight: 600;
    }

    .post-description {
        padding: 0 16px 16px;
    }

    .post-comments {
        padding: 0 16px;
        color: #8e8e8e;
    }

    .action-btn {
        background: none;
        border: none;
        cursor: pointer;
        font-size: 24px;
        padding: 8px;
    }
</style>
{% endblock %}

{% block body %}
<div class="feed">
    {% for publicacion in publicacionesSeguidas %}
        <article class="post-card">
            <header class="post-header">
                <a href="#" class="post-user">{{ publicacion.userPost.username }}</a>
            </header>

            <img src="{{ asset('uploads/photos/' ~ publicacion.img) }}" alt="Publicaci√≥n" class="post-image">

            <div class="post-actions">
                <a href="{{ path('app_publicacion_like', {'id': publicacion.id}) }}" class="action-btn">
                    {% set userLiked = false %}
                    {% for like in publicacion.likes %}
                        {% if like.user.id == app.user.id %}
                            {% set userLiked = true %}
                        {% endif %}
                    {% endfor %}
                    {{ userLiked ? '‚ù§Ô∏è' : 'ü§ç' }}
                </a>
                <a href="{{ path('app_comment_new', {'id': publicacion.id}) }}" class="action-btn">üí¨</a>
            </div>

            <div class="post-likes">
                {{ publicacion.likes }} Me gusta
            </div>

            <div class="post-description">
                <strong>{{ publicacion.userPost.username }}</strong> {{ publicacion.description }}
            </div>

            <div class="post-comments">
                Ver los {{ publicacion.comments|length }} comentarios
            </div>
        </article>
    {% endfor %}
</div>
{% endblock %}
